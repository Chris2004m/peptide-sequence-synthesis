# Peptide Sequence Synthesis

A tool for generating reference peptide sets

## Features

- **Four peptide generation modes:**
  - Random (from 20 amino acids)
  - Sampled from a user-supplied FASTA file
  - Generated by ProtGPT2 language model (interactive proteome workflow)
  - Generated by ESM2 language model (direct generation)
- **FASTA output** compatible with pVACtools
- **Command-line interface** for batch processing
- **Progress indicators** for all generation methods
- **Reproducible and documented**: All parameters and code are managed in git

## Requirements

- Python 3.8+
- [transformers](https://huggingface.co/docs/transformers/index)
- [torch](https://pytorch.org/)
- [tqdm](https://tqdm.github.io/)

Install dependencies with:
```bash
pip install -r requirements.txt
```

> **Note:** You do **not** need to install pVACtools or IEDB locally. All pvacbind predictions are executed inside the official Docker container [`griffithlab/pvactools:latest`](https://hub.docker.com/r/griffithlab/pvactools/) via `scripts/tools/docker_pvactools_runner.py`, ensuring consistent dependencies across systems.
```

## Usage

### Random Generation
Generate 100 random 9-mer peptides:
```bash
python scripts/generation/generate_control_peptides.py --source random --length 9 --count 100 --output Random-9mer-100.fasta
```

### FASTA Sampling
Sample 100 9-mer peptides from a reference proteome:
```bash
python scripts/generation/generate_control_peptides.py --source fasta --length 9 --count 100 --fasta_file data/protein.faa --output RefProteome-9mer-100.fasta
```

### ProtGPT2 Generation
Generate 100 9-mer peptides using ProtGPT2 (interactive workflow):
```bash
python scripts/generation/generate_control_peptides.py --source llm --llm_model protgpt2 --length 9 --count 100 --output ProtGPT2-9mer-100.fasta
```
*This will prompt you to either use an existing proteome or generate a new synthetic proteome.*

### ESM2 Generation
Generate 100 9-mer peptides using ESM2 (direct generation):
```bash
python scripts/generation/generate_control_peptides.py --source llm --llm_model esm2 --length 9 --count 100 --output ESM2-9mer-100.fasta
```

## Docker Usage

Run the tool using Docker (no local setup required):

```bash
# Pull the latest image
docker pull chris2004m/peptide-sequence-synthesis:latest

# Run with Docker (interactive mode)
docker run -it --rm -v $(pwd)/output:/app/output chris2004m/peptide-sequence-synthesis:latest

# Inside the container, run any of the commands above, e.g.:
python scripts/generation/generate_control_peptides.py --source random --length 9 --count 100 --output output/Random-9mer-100.fasta
```

## Acknowledgements

- [ProtGPT2](https://huggingface.co/nferruz/ProtGPT2)
- [ESM2](https://huggingface.co/facebook/esm2_t6_8M_UR50D)
