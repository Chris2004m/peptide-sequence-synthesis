# Peptide Sequence Synthesis

A tool for generating reference peptide sets

## Features

- **Three peptide generation modes:**
  - Random (from 20 amino acids)
  - Sampled from a user-supplied FASTA file
  - Generated by protein language models (ProtGPT2 or ESM-2 via HuggingFace Transformers)
- **FASTA output** compatible with pVACtools
- **Command-line interface** for batch processing
- **Simple GUI** (using PySimpleGUI) for non-technical users
- **Reproducible and documented**: All parameters and code are managed in git

## Requirements

- Python 3.8+
- [PySimpleGUI](https://pysimplegui.readthedocs.io/)
- [transformers](https://huggingface.co/docs/transformers/index)
- [torch](https://pytorch.org/)

Install dependencies with:
```bash
pip install -r requirements.txt
```

> **Note:** You do **not** need to install pVACtools or IEDB locally. All pvacbind predictions are executed inside the official Docker container [`griffithlab/pvactools:latest`](https://hub.docker.com/r/griffithlab/pvactools/) via `scripts/tools/docker_pvactools_runner.py`, ensuring consistent dependencies across systems.
```

## Usage

### Command Line

```bash
# Random generation - Generate 1000 random 9-mer peptides
python scripts/generation/generate_control_peptides.py --source random --length 9 --count 1000 --output Random-9mer-1000.fasta --seed 42

# FASTA sampling - Sample 1000 9-mer peptides from reference proteome
python scripts/generation/generate_control_peptides.py --source fasta --length 9 --count 1000 --fasta_file data/protein.faa --output RefProteome-9mer-1000.fasta

# ProtGPT2 generation - Interactive workflow to generate peptides from synthetic proteins
python scripts/generation/generate_control_peptides.py --source llm --llm_model protgpt2 --length 9 --count 1000 --output ProtGPT2-9mer-1000.fasta
# This will prompt you to either:
# 1) Use an existing ProtGPT2-generated proteome, or
# 2) Generate a new synthetic proteome using ProtGPT2

# Generate different peptide lengths with descriptive names
python scripts/generation/generate_control_peptides.py --source random --length 8 --count 5000 --output Random-8mer-5000.fasta
python scripts/generation/generate_control_peptides.py --source llm --llm_model protgpt2 --length 10 --count 2000 --output ProtGPT2-10mer-2000.fasta
```

### GUI

```bash
python peptide_gui.py
```
Follow the prompts to select generation mode, parameters, and output file.

## Acknowledgements

- [ProtGPT2](https://huggingface.co/nferruz/ProtGPT2)
- [PySimpleGUI](https://pysimplegui.readthedocs.io/)
